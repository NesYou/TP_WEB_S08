<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script language="javascript">
        var xmlhttp;
        function init() {
            // put more code here in case you are concerned about browsers that do not provide XMLHttpRequest object directly
            xmlhttp = new XMLHttpRequest();
            var lesSondages = document.getElementById("lesSondages");


            var baseurl = document.getElementById("baseurl").value;
            var url = baseurl + "/sondages/";

            xmlhttp.open('GET',url,true);
            xmlhttp.send(null);

            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == 4) {
                    if ( xmlhttp.status == 200) {
                        var sondage = JSON.parse(xmlhttp.responseText);
                        for(var i = 0; i < sondage.length; i++) {
                            var opt = document.createElement('option');
                            opt.innerHTML = sondage[i].question;
                            opt.value = sondage.question;
                            lesSondages.appendChild(opt);
                        }
                    }
                    else
                        alert("Error!!! -> " + xmlhttp.responseText);
                }
            };


        }

        function getSondage() {
            var baseurl = document.getElementById("baseurl").value;
            var sondageid = document.getElementById("sondageid").value;
            var url = baseurl + "/sondages/" + sondageid;
            xmlhttp.open('GET',url,true);
            xmlhttp.send(null);

            xmlhttp.onreadystatechange = function() {
                if (xmlhttp.readyState == 4) {
                    if ( xmlhttp.status == 200) {
                        var sondage = JSON.parse(xmlhttp.responseText);
                        document.getElementById("libelle").value = sondage.question;
                    }
                    else
                        alert("Error!!! -> " + xmlhttp.responseText);
                }
            };
        }
    </script>
</head>
<body onload="init()">
<h1>Sondage RESTful Web Service Demo</h1>
<table>
    <tr>
        <td>Url de base du service REST</td>
        <td><input type="text" id="baseurl" size="30" value="http://localhost:8080/rest"/>
    </tr>

    <tr>
        <td colspan="2">----------------------------------------------------- </td>
    </tr>
    <!--
    <tr>
        <td>Id du Sondage</td>
        <td><input type="text" id="sondageid" size="10"/>
        <td><input type="button" value="Lire le sondage" onclick="getSondage()"/></td>
    </tr>

    <tr>
        <td>Options : </td>
        <td><input type="text" readonly="true" id="libelle" size="20"/> </td>
    </tr>
    -->


    <tr>
        <td>
            <form>
                <label for="lesSondages">Liste des songades : </label>
                <select name = "lesSondages" id = "lesSondages"></select>
                <input type="submit" value="Consulter sondage">
            </form>
        </td>
    </tr>

</table>
</body>
</html>